---
title: test
author: ''
date: '2018-02-15'
slug: test
categories: []
tags: []
header:
  caption: ''
  image: ''
---

<link href="Fitting_Nematode_Models_files/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="Fitting_Nematode_Models_files/pagedtable-1.1/js/pagedtable.js"></script>


<p><a href="https://zenodo.org/badge/latestdoi/119438897"><img src="https://zenodo.org/badge/119438897.svg" alt="DOI" /></a></p>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p><em>Pratylenchus thornei</em>, the root-lesion nematode, is widely distributed in wheat
(<em>Triticum aestivum</em>) growing areas of many countries and is of particular
concern in sub-tropical environments <span class="citation">(Thompson 2015)</span>. These nematodes penetrate
roots to feed and reproduce in the root cortex leading to loss of root
function, which affects nutrient and water uptake of nutrients and water causing
nutrient deficiency and water stress <span class="citation">(Thompson 2015)</span>.</p>
<p>In the original paper the population response of <em>P. thornei</em> in Queensland,
Australia wheat to temperature is modelled using a linear and quadratic
equations. The study aimed to investigate the effects of soil profile
temperatures after different sowing dates on reproduction of the nematodes in
susceptible and moderately resistant wheat cultivars in the subtropical grain
region of eastern Australia. This document recreates the models for population
densities of <em>P. thornei</em> as described in the original paper.</p>
<div id="objectives" class="section level2">
<h2>Objectives</h2>
<p>There are two types of models described in the paper, the first model is a
linear model used to describe the unplanted control and two quadratic models fit
Gatcher (Susceptible) and GS50a (Moderately Resistant) wheat cultivars. For a
more detailed discussion on fitting plant disease models in R, please see the
“<a href="http://www.apsnet.org/edcenter/advanced/topics/EcologyAndEpidemiologyInR/DiseaseProgress/Pages/LinearRegression.aspx">Linear Regression</a>” module in the “Ecology and Epidemiology
in R” documents available in the American Phytopathological Society’s (APS)
Education Center. For an even more in-depth discussion on linear models in R,
how to fit and how to interpret the diagnostics that R provides the reader
should refer to Faraway <span class="citation">(2002)</span>.</p>
<p>This post will illustrate how to fit the original linear and quadratic models
using the original data in R <span class="citation">(R Core Team 2017)</span>.</p>
</div>
</div>
<div id="packages" class="section level1">
<h1>Packages</h1>
<p>Using the <strong><code>tidyverse</code></strong>, <span class="citation">(2017)</span> package simplifies the libraries
used in this work. It is a collection of packages designed to work together for
data science, <a href="https://www.tidyverse.org/" class="uri">https://www.tidyverse.org/</a>. The <strong><code>tidyverse</code></strong> includes,
<strong><code>readr</code></strong> <span class="citation">(2017)</span>, used to import the data; <strong><code>tidyr</code></strong>
<span class="citation">(2018)</span>, used to format the data; <strong><code>dplyr</code></strong> <span class="citation">(2017)</span>, used to
subset the data; and <strong><code>ggplot2</code></strong> <span class="citation">(2016)</span>, used for visualising the
data and model fits. <strong><code>viridis</code></strong> <span class="citation">(2018)</span> is a selection of colour
pallets that are widely accessible for people with colour-blindness and printing
in black and white.</p>
<p>The following code chunk checks first to see if you have <strong><code>tidyverse</code></strong> and
<strong><code>viridis</code></strong> installed, if not, it will automatically install them and then
load them.</p>
<pre class="r"><code>if (!require(tidyverse)) {
  install.packages(&quot;tidyverse&quot;,
                   repos = c(CRAN = &quot;https://cloud.r-project.org/&quot;))
  library(tidyverse)
}

if (!require(viridis)) {
  install.packages(&quot;viridis&quot;,
                   repos = c(CRAN = &quot;https://cloud.r-project.org/&quot;))
  library(viridis)
}</code></pre>
</div>
<div id="data-wrangling" class="section level1">
<h1>Data Wrangling</h1>
<p>The data are located in the <code>data</code> sub-folder. Import the data using
<code>read_csv()</code> function from <strong><code>readr</code></strong> and view them.</p>
<pre class="r"><code>nema &lt;- read_csv(&quot;data/Nematode_Data.csv&quot;)

nema</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Weeks"],"name":[1],"type":["int"],"align":["right"]},{"label":["Days"],"name":[2],"type":["int"],"align":["right"]},{"label":["Temperature"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Degree_days"],"name":[4],"type":["int"],"align":["right"]},{"label":["Unplanted"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Gatcher"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["GS50a"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Potam"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["Suneca"],"name":[9],"type":["dbl"],"align":["right"]}],"data":[{"1":"8","2":"56","3":"15.0","4":"280","5":"5.748","6":"6.773","7":"6.691","8":"7.613","9":"6.703"},{"1":"8","2":"56","3":"20.0","4":"560","5":"5.915","6":"9.513","7":"7.420","8":"9.285","9":"9.121"},{"1":"8","2":"56","3":"22.5","4":"700","5":"6.381","6":"9.956","7":"8.214","8":"9.024","9":"10.012"},{"1":"8","2":"56","3":"25.0","4":"840","5":"6.510","6":"9.354","7":"8.254","8":"9.732","9":"9.202"},{"1":"10","2":"70","3":"15.0","4":"350","5":"5.847","6":"7.435","7":"6.043","8":"5.972","9":"6.846"},{"1":"10","2":"70","3":"20.0","4":"700","5":"6.157","6":"10.338","7":"8.915","8":"10.284","9":"10.175"},{"1":"10","2":"70","3":"22.5","4":"875","5":"6.191","6":"10.423","7":"9.183","8":"10.691","9":"10.075"},{"1":"10","2":"70","3":"25.0","4":"1050","5":"6.364","6":"10.580","7":"9.045","8":"10.487","9":"10.344"},{"1":"12","2":"84","3":"15.0","4":"420","5":"5.755","6":"9.926","7":"8.187","8":"8.745","9":"9.573"},{"1":"12","2":"84","3":"20.0","4":"840","5":"6.978","6":"11.723","7":"9.852","8":"11.334","9":"11.684"},{"1":"12","2":"84","3":"22.5","4":"1050","5":"6.382","6":"12.272","7":"10.297","8":"12.118","9":"11.359"},{"1":"12","2":"84","3":"25.0","4":"1260","5":"6.759","6":"11.803","7":"10.115","8":"12.065","9":"11.487"},{"1":"14","2":"98","3":"15.0","4":"490","5":"5.754","6":"10.269","7":"8.232","8":"10.014","9":"9.775"},{"1":"14","2":"98","3":"20.0","4":"980","5":"6.958","6":"11.840","7":"10.141","8":"11.882","9":"11.633"},{"1":"14","2":"98","3":"22.5","4":"1225","5":"7.305","6":"13.101","7":"10.015","8":"12.440","9":"12.731"},{"1":"14","2":"98","3":"25.0","4":"1470","5":"7.509","6":"13.192","7":"11.075","8":"12.453","9":"12.514"},{"1":"16","2":"112","3":"15.0","4":"560","5":"5.892","6":"10.824","7":"9.352","8":"10.271","9":"10.279"},{"1":"16","2":"112","3":"20.0","4":"1120","5":"7.454","6":"12.591","7":"10.004","8":"13.006","9":"13.128"},{"1":"16","2":"112","3":"22.5","4":"1400","5":"7.144","6":"13.532","7":"11.350","8":"13.009","9":"13.250"},{"1":"16","2":"112","3":"25.0","4":"1680","5":"8.084","6":"13.032","7":"11.598","8":"12.653","9":"12.995"},{"1":"18","2":"126","3":"15.0","4":"630","5":"7.216","6":"11.168","7":"9.357","8":"10.892","9":"10.534"},{"1":"18","2":"126","3":"20.0","4":"1260","5":"6.957","6":"13.417","7":"11.005","8":"12.209","9":"12.998"},{"1":"18","2":"126","3":"22.5","4":"1575","5":"7.549","6":"13.167","7":"10.687","8":"12.640","9":"13.610"},{"1":"18","2":"126","3":"25.0","4":"1890","5":"7.202","6":"12.913","7":"11.068","8":"12.458","9":"13.472"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>nrow(nema)</code></pre>
<pre><code>## [1] 24</code></pre>
<div id="description-of-fields-in-the-data" class="section level3">
<h3>Description of Fields in the Data</h3>
<p>There are nine columns in the <code>nema</code> data described here in the following table.</p>
<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Field
</th>
<th style="text-align:left;">
Data Description
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Weeks
</td>
<td style="text-align:left;">
Number of weeks after wheat sowing
</td>
</tr>
<tr>
<td style="text-align:left;">
Days
</td>
<td style="text-align:left;">
Number of days after wheat sowing
</td>
</tr>
<tr>
<td style="text-align:left;">
Temperature
</td>
<td style="text-align:left;">
Temperature (˚C) treatment
</td>
</tr>
<tr>
<td style="text-align:left;">
Degree_Days
</td>
<td style="text-align:left;">
Average thermal time degree days above 10 ˚C for four soil depths
(8, 15, 30 and 60 cm)
</td>
</tr>
<tr>
<td style="text-align:left;">
Unplanted
</td>
<td style="text-align:left;">
Log<sup>*</sup>, <code>log()</code>, nematode population in
the control treatment with no wheat planted
</td>
</tr>
<tr>
<td style="text-align:left;">
Gatcher
</td>
<td style="text-align:left;">
Log<sup>*</sup>, <code>log()</code>, nematode population in a
susceptible wheat cultivar
</td>
</tr>
<tr>
<td style="text-align:left;">
GS50a
</td>
<td style="text-align:left;">
Log<sup>*</sup>, <code>log()</code>, nematode population in a
moderately resistant wheat cultivar
</td>
</tr>
<tr>
<td style="text-align:left;">
Potam
</td>
<td style="text-align:left;">
Log<sup>*</sup>, <code>log()</code>, nematode population in a
susceptible wheat cultivar
</td>
</tr>
<tr>
<td style="text-align:left;">
Suneca
</td>
<td style="text-align:left;">
Log<sup>*</sup>, <code>log()</code>, nematode population in a
susceptible wheat cultivar
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; border: 0;" colspan="100%">
<sup>*</sup> For an exploration into the reasons why the data were transformed
using the natural log <code>log()</code>, see the
<a href="#exploring-why-the-data-were-log-transformed">Exploring Why the Data Were Log Transformed</a> in the
<a href="#bonus-material">Bonus Material</a> section
</td>
</tr>
</tfoot>
</table>
</div>
<div id="wide-to-long-data" class="section level3">
<h3>Wide to Long Data</h3>
<p>You can see that each of the varieties have their own column in the original
data format, this is commonly called wide data. Wide data are commonly found in
spreadsheets but do not lend themselves easily to data analysis, modelling and
visualisation. To make it easier to do these things it is common to convert the
data from wide to long format, commonly referred to as tidying, when using R.
The advantage of a tidy dataset is that it is easy to manipulate, model and
visualize, and always has a specific structure where each variable is a column,
each observation is a row, and each type of observational unit is a table
<span class="citation">(Wickham 2014)</span>.</p>
<p>In order to use <strong><code>ggplot2</code></strong> for visualising the data, they need to be
converted from wide to long. Using <code>gather()</code> from the <strong><code>tidyr</code></strong> package to
convert from wide to long format where the varieties are all listed in a single
column, <code>Variety</code>.</p>
<pre class="r"><code>nema_long &lt;- nema %&gt;% gather(Variety, Log_pop, Unplanted:Suneca)

nema_long</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Weeks"],"name":[1],"type":["int"],"align":["right"]},{"label":["Days"],"name":[2],"type":["int"],"align":["right"]},{"label":["Temperature"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Degree_days"],"name":[4],"type":["int"],"align":["right"]},{"label":["Variety"],"name":[5],"type":["chr"],"align":["left"]},{"label":["Log_pop"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"8","2":"56","3":"15.0","4":"280","5":"Unplanted","6":"5.748"},{"1":"8","2":"56","3":"20.0","4":"560","5":"Unplanted","6":"5.915"},{"1":"8","2":"56","3":"22.5","4":"700","5":"Unplanted","6":"6.381"},{"1":"8","2":"56","3":"25.0","4":"840","5":"Unplanted","6":"6.510"},{"1":"10","2":"70","3":"15.0","4":"350","5":"Unplanted","6":"5.847"},{"1":"10","2":"70","3":"20.0","4":"700","5":"Unplanted","6":"6.157"},{"1":"10","2":"70","3":"22.5","4":"875","5":"Unplanted","6":"6.191"},{"1":"10","2":"70","3":"25.0","4":"1050","5":"Unplanted","6":"6.364"},{"1":"12","2":"84","3":"15.0","4":"420","5":"Unplanted","6":"5.755"},{"1":"12","2":"84","3":"20.0","4":"840","5":"Unplanted","6":"6.978"},{"1":"12","2":"84","3":"22.5","4":"1050","5":"Unplanted","6":"6.382"},{"1":"12","2":"84","3":"25.0","4":"1260","5":"Unplanted","6":"6.759"},{"1":"14","2":"98","3":"15.0","4":"490","5":"Unplanted","6":"5.754"},{"1":"14","2":"98","3":"20.0","4":"980","5":"Unplanted","6":"6.958"},{"1":"14","2":"98","3":"22.5","4":"1225","5":"Unplanted","6":"7.305"},{"1":"14","2":"98","3":"25.0","4":"1470","5":"Unplanted","6":"7.509"},{"1":"16","2":"112","3":"15.0","4":"560","5":"Unplanted","6":"5.892"},{"1":"16","2":"112","3":"20.0","4":"1120","5":"Unplanted","6":"7.454"},{"1":"16","2":"112","3":"22.5","4":"1400","5":"Unplanted","6":"7.144"},{"1":"16","2":"112","3":"25.0","4":"1680","5":"Unplanted","6":"8.084"},{"1":"18","2":"126","3":"15.0","4":"630","5":"Unplanted","6":"7.216"},{"1":"18","2":"126","3":"20.0","4":"1260","5":"Unplanted","6":"6.957"},{"1":"18","2":"126","3":"22.5","4":"1575","5":"Unplanted","6":"7.549"},{"1":"18","2":"126","3":"25.0","4":"1890","5":"Unplanted","6":"7.202"},{"1":"8","2":"56","3":"15.0","4":"280","5":"Gatcher","6":"6.773"},{"1":"8","2":"56","3":"20.0","4":"560","5":"Gatcher","6":"9.513"},{"1":"8","2":"56","3":"22.5","4":"700","5":"Gatcher","6":"9.956"},{"1":"8","2":"56","3":"25.0","4":"840","5":"Gatcher","6":"9.354"},{"1":"10","2":"70","3":"15.0","4":"350","5":"Gatcher","6":"7.435"},{"1":"10","2":"70","3":"20.0","4":"700","5":"Gatcher","6":"10.338"},{"1":"10","2":"70","3":"22.5","4":"875","5":"Gatcher","6":"10.423"},{"1":"10","2":"70","3":"25.0","4":"1050","5":"Gatcher","6":"10.580"},{"1":"12","2":"84","3":"15.0","4":"420","5":"Gatcher","6":"9.926"},{"1":"12","2":"84","3":"20.0","4":"840","5":"Gatcher","6":"11.723"},{"1":"12","2":"84","3":"22.5","4":"1050","5":"Gatcher","6":"12.272"},{"1":"12","2":"84","3":"25.0","4":"1260","5":"Gatcher","6":"11.803"},{"1":"14","2":"98","3":"15.0","4":"490","5":"Gatcher","6":"10.269"},{"1":"14","2":"98","3":"20.0","4":"980","5":"Gatcher","6":"11.840"},{"1":"14","2":"98","3":"22.5","4":"1225","5":"Gatcher","6":"13.101"},{"1":"14","2":"98","3":"25.0","4":"1470","5":"Gatcher","6":"13.192"},{"1":"16","2":"112","3":"15.0","4":"560","5":"Gatcher","6":"10.824"},{"1":"16","2":"112","3":"20.0","4":"1120","5":"Gatcher","6":"12.591"},{"1":"16","2":"112","3":"22.5","4":"1400","5":"Gatcher","6":"13.532"},{"1":"16","2":"112","3":"25.0","4":"1680","5":"Gatcher","6":"13.032"},{"1":"18","2":"126","3":"15.0","4":"630","5":"Gatcher","6":"11.168"},{"1":"18","2":"126","3":"20.0","4":"1260","5":"Gatcher","6":"13.417"},{"1":"18","2":"126","3":"22.5","4":"1575","5":"Gatcher","6":"13.167"},{"1":"18","2":"126","3":"25.0","4":"1890","5":"Gatcher","6":"12.913"},{"1":"8","2":"56","3":"15.0","4":"280","5":"GS50a","6":"6.691"},{"1":"8","2":"56","3":"20.0","4":"560","5":"GS50a","6":"7.420"},{"1":"8","2":"56","3":"22.5","4":"700","5":"GS50a","6":"8.214"},{"1":"8","2":"56","3":"25.0","4":"840","5":"GS50a","6":"8.254"},{"1":"10","2":"70","3":"15.0","4":"350","5":"GS50a","6":"6.043"},{"1":"10","2":"70","3":"20.0","4":"700","5":"GS50a","6":"8.915"},{"1":"10","2":"70","3":"22.5","4":"875","5":"GS50a","6":"9.183"},{"1":"10","2":"70","3":"25.0","4":"1050","5":"GS50a","6":"9.045"},{"1":"12","2":"84","3":"15.0","4":"420","5":"GS50a","6":"8.187"},{"1":"12","2":"84","3":"20.0","4":"840","5":"GS50a","6":"9.852"},{"1":"12","2":"84","3":"22.5","4":"1050","5":"GS50a","6":"10.297"},{"1":"12","2":"84","3":"25.0","4":"1260","5":"GS50a","6":"10.115"},{"1":"14","2":"98","3":"15.0","4":"490","5":"GS50a","6":"8.232"},{"1":"14","2":"98","3":"20.0","4":"980","5":"GS50a","6":"10.141"},{"1":"14","2":"98","3":"22.5","4":"1225","5":"GS50a","6":"10.015"},{"1":"14","2":"98","3":"25.0","4":"1470","5":"GS50a","6":"11.075"},{"1":"16","2":"112","3":"15.0","4":"560","5":"GS50a","6":"9.352"},{"1":"16","2":"112","3":"20.0","4":"1120","5":"GS50a","6":"10.004"},{"1":"16","2":"112","3":"22.5","4":"1400","5":"GS50a","6":"11.350"},{"1":"16","2":"112","3":"25.0","4":"1680","5":"GS50a","6":"11.598"},{"1":"18","2":"126","3":"15.0","4":"630","5":"GS50a","6":"9.357"},{"1":"18","2":"126","3":"20.0","4":"1260","5":"GS50a","6":"11.005"},{"1":"18","2":"126","3":"22.5","4":"1575","5":"GS50a","6":"10.687"},{"1":"18","2":"126","3":"25.0","4":"1890","5":"GS50a","6":"11.068"},{"1":"8","2":"56","3":"15.0","4":"280","5":"Potam","6":"7.613"},{"1":"8","2":"56","3":"20.0","4":"560","5":"Potam","6":"9.285"},{"1":"8","2":"56","3":"22.5","4":"700","5":"Potam","6":"9.024"},{"1":"8","2":"56","3":"25.0","4":"840","5":"Potam","6":"9.732"},{"1":"10","2":"70","3":"15.0","4":"350","5":"Potam","6":"5.972"},{"1":"10","2":"70","3":"20.0","4":"700","5":"Potam","6":"10.284"},{"1":"10","2":"70","3":"22.5","4":"875","5":"Potam","6":"10.691"},{"1":"10","2":"70","3":"25.0","4":"1050","5":"Potam","6":"10.487"},{"1":"12","2":"84","3":"15.0","4":"420","5":"Potam","6":"8.745"},{"1":"12","2":"84","3":"20.0","4":"840","5":"Potam","6":"11.334"},{"1":"12","2":"84","3":"22.5","4":"1050","5":"Potam","6":"12.118"},{"1":"12","2":"84","3":"25.0","4":"1260","5":"Potam","6":"12.065"},{"1":"14","2":"98","3":"15.0","4":"490","5":"Potam","6":"10.014"},{"1":"14","2":"98","3":"20.0","4":"980","5":"Potam","6":"11.882"},{"1":"14","2":"98","3":"22.5","4":"1225","5":"Potam","6":"12.440"},{"1":"14","2":"98","3":"25.0","4":"1470","5":"Potam","6":"12.453"},{"1":"16","2":"112","3":"15.0","4":"560","5":"Potam","6":"10.271"},{"1":"16","2":"112","3":"20.0","4":"1120","5":"Potam","6":"13.006"},{"1":"16","2":"112","3":"22.5","4":"1400","5":"Potam","6":"13.009"},{"1":"16","2":"112","3":"25.0","4":"1680","5":"Potam","6":"12.653"},{"1":"18","2":"126","3":"15.0","4":"630","5":"Potam","6":"10.892"},{"1":"18","2":"126","3":"20.0","4":"1260","5":"Potam","6":"12.209"},{"1":"18","2":"126","3":"22.5","4":"1575","5":"Potam","6":"12.640"},{"1":"18","2":"126","3":"25.0","4":"1890","5":"Potam","6":"12.458"},{"1":"8","2":"56","3":"15.0","4":"280","5":"Suneca","6":"6.703"},{"1":"8","2":"56","3":"20.0","4":"560","5":"Suneca","6":"9.121"},{"1":"8","2":"56","3":"22.5","4":"700","5":"Suneca","6":"10.012"},{"1":"8","2":"56","3":"25.0","4":"840","5":"Suneca","6":"9.202"},{"1":"10","2":"70","3":"15.0","4":"350","5":"Suneca","6":"6.846"},{"1":"10","2":"70","3":"20.0","4":"700","5":"Suneca","6":"10.175"},{"1":"10","2":"70","3":"22.5","4":"875","5":"Suneca","6":"10.075"},{"1":"10","2":"70","3":"25.0","4":"1050","5":"Suneca","6":"10.344"},{"1":"12","2":"84","3":"15.0","4":"420","5":"Suneca","6":"9.573"},{"1":"12","2":"84","3":"20.0","4":"840","5":"Suneca","6":"11.684"},{"1":"12","2":"84","3":"22.5","4":"1050","5":"Suneca","6":"11.359"},{"1":"12","2":"84","3":"25.0","4":"1260","5":"Suneca","6":"11.487"},{"1":"14","2":"98","3":"15.0","4":"490","5":"Suneca","6":"9.775"},{"1":"14","2":"98","3":"20.0","4":"980","5":"Suneca","6":"11.633"},{"1":"14","2":"98","3":"22.5","4":"1225","5":"Suneca","6":"12.731"},{"1":"14","2":"98","3":"25.0","4":"1470","5":"Suneca","6":"12.514"},{"1":"16","2":"112","3":"15.0","4":"560","5":"Suneca","6":"10.279"},{"1":"16","2":"112","3":"20.0","4":"1120","5":"Suneca","6":"13.128"},{"1":"16","2":"112","3":"22.5","4":"1400","5":"Suneca","6":"13.250"},{"1":"16","2":"112","3":"25.0","4":"1680","5":"Suneca","6":"12.995"},{"1":"18","2":"126","3":"15.0","4":"630","5":"Suneca","6":"10.534"},{"1":"18","2":"126","3":"20.0","4":"1260","5":"Suneca","6":"12.998"},{"1":"18","2":"126","3":"22.5","4":"1575","5":"Suneca","6":"13.610"},{"1":"18","2":"126","3":"25.0","4":"1890","5":"Suneca","6":"13.472"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>nrow(nema_long)</code></pre>
<pre><code>## [1] 120</code></pre>
<p>As we see, the original <code>nema</code> data had only 24 rows and the long
format of the data have 120 rows now.</p>
</div>
</div>
<div id="data-visualisation" class="section level1">
<h1>Data Visualisation</h1>
<p>Now that the data are in the format that <strong><code>ggplot2</code></strong> uses, take a look at
the data first to see what it looks like. Here we fit a smoothed line for each
variety’s nematode population to the raw data. The individual temperature
treatments are shown here by shape, the variety by colour.</p>
<pre class="r"><code>ggplot(
  nema_long,
  aes(
    x = Degree_days,
    y = Log_pop,
    colour = Temperature,
    group = Variety
  )
) +
  geom_point() +
  geom_smooth(colour = &quot;grey&quot;,
              se = FALSE,
              alpha = 0.5) +
  ylab(expression(paste(&quot;ln(&quot;,
                        italic(&quot;P. thornei&quot;),
                        &quot;/kg soil) + 1&quot;),
                  sep = &quot;&quot;)) +
  xlab(&quot;Thermal Time (˚C Days Above 10˚C)&quot;) +
  theme_minimal() +
  scale_colour_viridis(&quot;Temperature&quot;) +
  facet_wrap( ~ Variety, ncol = 2)</code></pre>
<p><img src="Fitting_Nematode_Models_files/figure-html4/raw_data_scatterplots-1.png" width="672" /></p>
</div>
<div id="modelling" class="section level1">
<h1>Modelling</h1>
<div id="unplanted-model" class="section level2">
<h2>Unplanted Model</h2>
<p>The paper uses a linear model for the unplanted control. Here we will write a
function to use in modelling the unplanted population data. I have wrapped the
model in a function which makes it pipe-able, <code>%&gt;%</code> and has other advantages
when it comes to fitting the same model to several sets of data.</p>
<p>In the linear equation for the Unplanted control treatment, the rate of
population increase can be expressed as:</p>
<p><span class="math display">\[y = y_0 + rt\]</span></p>
<p>Where <span class="math inline">\(y_0\)</span> is the initial population, <span class="math inline">\(r\)</span> is the rate of change and <span class="math inline">\(t\)</span>
equal time.</p>
<div id="fitting-a-linear-model" class="section level3">
<h3>Fitting a Linear Model</h3>
<pre class="r"><code>linear_model &lt;- function(df) {
  lm(Log_pop ~ Degree_days,
     data = df)
}</code></pre>
<p>Now check the model fit, using <code>filter()</code> from <strong><code>dplyr</code></strong> to select only
Unplanted data from the data set for the model and fit the linear model to the
data.</p>
<pre class="r"><code>unplanted_model &lt;- nema_long %&gt;%
  filter(Variety == &quot;Unplanted&quot;) %&gt;%
  linear_model()</code></pre>
<p>Using <code>par(mfrow = c(2, 2))</code> creates a four-panel graph rather than four
individual graphs, which the next function will create by default.</p>
<p>Using the <code>plot()</code> function with any <code>lm()</code> object will create four diagnostic
plots for your inspection.</p>
<pre class="r"><code>par(mfrow = c(2, 2))
plot(unplanted_model)</code></pre>
<p><img src="Fitting_Nematode_Models_files/figure-html4/plot_model-1.png" width="672" /></p>
<p>These plots do not appear to indicate anything amiss as one would hope for from
the models that have already been published. If you are unfamiliar with how to
interpret these diagnostic plots see <a href="#interpreting-linear-models-in-r">Interpreting Linear Models in R</a> in the
<a href="#further-reading">Further Reading</a> section.</p>
<p>Using the <code>summary()</code> function displays information about the model fit. If you
are unfamiliar with how to read and interpret the output of <code>summary()</code> for a
linear model, please refer to <a href="#interpreting-linear-models-in-r">Interpreting Linear Models in R</a> in the
<a href="#further-reading">Further Reading</a> section for references that go into more detail on this matter.</p>
<pre class="r"><code>summary(unplanted_model)</code></pre>
<pre><code>## 
## Call:
## lm(formula = Log_pop ~ Degree_days, data = df)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.66053 -0.25811 -0.05683  0.21123  0.98511 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 5.4150643  0.1929731  28.061  &lt; 2e-16 ***
## Degree_days 0.0012950  0.0001823   7.103 4.01e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3847 on 22 degrees of freedom
## Multiple R-squared:  0.6964, Adjusted R-squared:  0.6826 
## F-statistic: 50.45 on 1 and 22 DF,  p-value: 4.006e-07</code></pre>
<p>From the original paper, the <span class="math inline">\(R^2\)</span> value of the unplanted linear model was
0.7, we can see here that agrees:
0.7. In the original paper,
<span class="math inline">\(P\)</span> &lt; 0.001, R reports <span class="math inline">\(p-value:\)</span>
4.006382710^{-7}, which also agrees.</p>
<div id="visualising-the-model-fit-to-the-data" class="section level4">
<h4>Visualising the Model Fit to the Data</h4>
<p>Using <strong><code>ggplot2</code></strong>’s <code>geom_smooth()</code> we can fit the same model above and graph
the resulting line.</p>
<pre class="r"><code>nema_long %&gt;%
  group_by(Variety) %&gt;%
  filter(Variety == &quot;Unplanted&quot;) %&gt;%
  ggplot(aes(
    x = Degree_days,
    y = Log_pop,
    colour = Temperature
  )) +
  geom_point() +
  geom_smooth(method = &quot;lm&quot;,
              formula = y ~ x,
              size = 1,
              se = FALSE,
              colour = &quot;grey&quot;,
              alpha = 0.5) +
  ylab(expression(paste(&quot;ln(&quot;,
                        italic(&quot;P. thornei&quot;),
                        &quot;/kg soil) + 1&quot;),
                  sep = &quot;&quot;)) +
  xlab(&quot;Thermal Time (˚C Days Above 10˚C)&quot;) +
  theme_minimal() +
  scale_colour_viridis(&quot;Temperature&quot;) +
  ggtitle(&quot;Unplanted Linear Model&quot;)</code></pre>
<p><img src="Fitting_Nematode_Models_files/figure-html4/visualise_linear-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="quadratic-models" class="section level2">
<h2>Quadratic Models</h2>
<p>In the original paper, the quadratic model best described Gatcher and GS50a
data, which are fit here.</p>
<pre class="r"><code>quadratic_model &lt;- function(df) {
  lm(Log_pop ~ Degree_days + I(Degree_days^2),
      data = df)
}</code></pre>
<div id="susceptible-varieties" class="section level3">
<h3>Susceptible Varieties</h3>
<p>Gatcher, Potam and Suneca all have very similar curves, here Gatcher is used to
fit a quadratic model as in the original paper following the same methods as
above for the linear model.</p>
<pre class="r"><code>s_model &lt;- nema_long %&gt;%
  filter(Variety == &quot;Gatcher&quot;) %&gt;% 
  quadratic_model()

par(mfrow = c(2, 2))
plot(s_model)</code></pre>
<p><img src="Fitting_Nematode_Models_files/figure-html4/susceptible_model-1.png" width="672" /></p>
<pre class="r"><code>summary(s_model)</code></pre>
<pre><code>## 
## Call:
## lm(formula = Log_pop ~ Degree_days + I(Degree_days^2), data = df)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.80668 -0.58936  0.07297  0.58228  1.14866 
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       5.476e+00  9.043e-01   6.055 5.21e-06 ***
## Degree_days       8.961e-03  1.909e-03   4.693 0.000124 ***
## I(Degree_days^2) -2.612e-06  9.008e-07  -2.899 0.008579 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.8631 on 21 degrees of freedom
## Multiple R-squared:  0.7998, Adjusted R-squared:  0.7808 
## F-statistic: 41.96 on 2 and 21 DF,  p-value: 4.621e-08</code></pre>
<p>From the original paper, the <span class="math inline">\(R^2\)</span> value of Gatcher’s quadratic model was 0.80,
we can see here that agrees: 0.8. In the
original paper, <span class="math inline">\(P\)</span> &lt; 0.001, R reports <span class="math inline">\(p-value:\)</span>
1.240363510^{-4}, which also agrees.</p>
<div id="visualise-susceptible-variety-model" class="section level4">
<h4>Visualise Susceptible Variety Model</h4>
<p>The model visualisation is the same for the quadratic models as the linear
model, however you will note that the line has a downward curve at higher
temperatures.</p>
<pre class="r"><code>nema_long %&gt;%
  group_by(Variety) %&gt;%
  filter(Variety == &quot;Gatcher&quot;) %&gt;%
  ggplot(aes(
    x = Degree_days,
    y = Log_pop,
    colour = Temperature,
  )) +
  geom_point() +
  geom_smooth(method = &quot;lm&quot;,
              formula = y ~ x + I(x^2),
              size = 1,
              se = FALSE,
              colour = &quot;grey&quot;,
              alpha = 0.5) +
  ylab(expression(paste(&quot;ln(&quot;,
                        italic(&quot;P. thornei&quot;),
                        &quot;/kg soil) + 1&quot;),
                  sep = &quot;&quot;)) +
  xlab(&quot;Thermal Time (˚C Days Above 10˚C)&quot;) +
  theme_minimal() +
  scale_colour_viridis(&quot;Temperature&quot;) +
  ggtitle(&quot;Gatcher Quadratic Model&quot;)</code></pre>
<p><img src="Fitting_Nematode_Models_files/figure-html4/visualise_s_model-1.png" width="672" /></p>
</div>
</div>
<div id="moderately-resistant-cultiver" class="section level3">
<h3>Moderately Resistant Cultiver</h3>
<p>GS50a, moderately resistant to <em>P. thornei</em>, also fits a quadratic model but the
coefficients are slightly different due to different responses to the variety
and temperature.</p>
<pre class="r"><code>mr_model &lt;- nema_long %&gt;%
  filter(Variety == &quot;GS50a&quot;) %&gt;%
  quadratic_model()

par(mfrow = c(2, 2))
plot(mr_model)</code></pre>
<p><img src="Fitting_Nematode_Models_files/figure-html4/moderately_resistant_model-1.png" width="672" /></p>
<pre class="r"><code>summary(mr_model)</code></pre>
<pre><code>## 
## Call:
## lm(formula = Log_pop ~ Degree_days + I(Degree_days^2), data = df)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.11285 -0.39845  0.02889  0.45494  1.18598 
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       5.157e+00  6.779e-01   7.607 1.83e-07 ***
## Degree_days       6.274e-03  1.431e-03   4.384  0.00026 ***
## I(Degree_days^2) -1.609e-06  6.753e-07  -2.383  0.02672 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.647 on 21 degrees of freedom
## Multiple R-squared:  0.8233, Adjusted R-squared:  0.8065 
## F-statistic: 48.92 on 2 and 21 DF,  p-value: 1.248e-08</code></pre>
<p>From the original paper, the <span class="math inline">\(R^2\)</span> value of GS50a’s quadratic model was 0.82,
we can see here that agrees: 0.82. In the
original paper, <span class="math inline">\(P\)</span> &lt; 0.001, R reports <span class="math inline">\(p-value:\)</span>
2.596147310^{-4}, which also agrees.</p>
<div id="visualising-the-model-fit-to-the-data-1" class="section level4">
<h4>Visualising the Model Fit to the Data</h4>
<pre class="r"><code>nema_long %&gt;%
  group_by(Variety) %&gt;%
  filter(Variety == &quot;GS50a&quot;) %&gt;%
  ggplot(aes(
    x = Degree_days,
    y = Log_pop,
    colour = Temperature,
  )) +
  geom_point() +
  geom_smooth(method = &quot;lm&quot;,
              formula = y ~ x + I(x^2),
              size = 1,
              se = FALSE,
              colour = &quot;grey&quot;,
              alpha = 0.5) +
  ylab(expression(paste(&quot;ln(&quot;,
                        italic(&quot;P. thornei&quot;),
                        &quot;/kg soil) + 1&quot;),
                  sep = &quot;&quot;)) +
  xlab(&quot;Thermal Time (˚C Days Above 10˚C)&quot;) +
  theme_minimal() +
  scale_colour_viridis(&quot;Temperature&quot;) +
  ggtitle(&quot;GS50a Quadratic Model&quot;)</code></pre>
<p><img src="Fitting_Nematode_Models_files/figure-html4/visualise_mr_model-1.png" width="672" /></p>
</div>
</div>
</div>
</div>
<div id="discussion-and-conclusions" class="section level1">
<h1>Discussion and Conclusions</h1>
<p>As in the original paper, the model equations can be derived from these models
as well. The derived regression equations are:</p>
<p>Gatcher (Susceptible):
<span class="math display">\[ln(P. thornei + 1) = -0.000003(0.0000009)T^2 + 0.009(0.0019)T + 5.4671(0.904)\]</span></p>
<p>GS50a (Moderately Resistant):
<span class="math display">\[ln(P. thornei + 1) = -0.000002(0.0000007)T^2 + 0.0063(0.0014)T + 5.1559(0.678)\]</span></p>
<p>Unplanted Control: <span class="math display">\[ln(P. thornei + 1) = 0.0013(0.00018)T + 5.4151(0.193)\]</span></p>
<p>Refer back to the <code>summary()</code> outputs for each of the models for the coefficient
values and <span class="math inline">\(R^2\)</span> values, which match those reported in the original paper where
the models were fit with Genstat.</p>
<p>Gatcher and GS50a have similar phenologies, but differ in resistance to root
lesion nematodes, making the model comparisons a reasonable objective. The
original paper goes on to test the effect of sowing date based on degree days.
<span class="citation">(Thompson 2015)</span> reported a 61% increase in yield on average from sowing Gatcher,
the susceptible, intolerant cultivar Gatcher at the end of May than sowing it
in the third week of June. By June the soil temperatures and nematode
populations were both greater, leading to lower wheat yield. The effects were
less pronounced in the moderately resistant cultivar, GS50a, but were similar
with a reduction occurring due to earlier planting.</p>
<p>The models illustrated here for Gatcher and GS50a were able accurately reflect
the changes in nematode population as a result of degree days, which affected
the nematodes’ ability to damage the crop and reduce yield <span class="citation">(Thompson 2015)</span>.</p>
</div>
<div id="bonus-material" class="section level1">
<h1>Bonus Material</h1>
<div id="exploring-why-the-data-were-log-transformed" class="section level2">
<h2>Exploring Why the Data Were Log Transformed</h2>
<p>In the paper the the natural log, <code>ln() +1</code>, of the nematode population counts
were used to fit the models. Here we will explore a bit further why this was
necessary.</p>
<p><em>A note about using <code>log() + 1</code> rather than just <code>log()</code>. This is necessary with
these data to avoid taking <code>log(0)</code>. Try it in R to see what happens if you are
not familiar.</em></p>
<p>First, plot the data for each of the four temperatures and the four varieties,
plus the unplanted control converting from the natural log value back to the
original actual count values to see what the population numbers look like. Note
the use of <code>exp() - 1</code> in the <code>y</code> aesthetic, to transform the values from the
<code>ln() + 1</code> values. Doing this shows us the original data’s values and helps
demonstrate why the data were log transformed for analysis. To examine the data,
first we will use boxplots and then quantile-quantile (qq) plots.</p>
<pre class="r"><code>ggplot(nema_long,
       aes(x = Temperature, 
           y = exp(Log_pop) - 1,
           group = Temperature,
           colour = Temperature)) +
  geom_boxplot(colour = &quot;grey&quot;,
               outlier.color = NA) +
  geom_jitter(width = 0.1,
              alpha = 0.6) +
  ylab(expression(paste(&quot;exp(ln(&quot;,
                        italic(&quot;P. thornei&quot;),
                        &quot;/kg soil) + 1)&quot;),
                  sep = &quot;&quot;)) +
  facet_wrap( ~ Variety,
              ncol = 2) +
  scale_colour_viridis(&quot;Temperature&quot;) +
  ggtitle(&quot;Untransformed Data&quot;) +
  theme_minimal()</code></pre>
<p><img src="Fitting_Nematode_Models_files/figure-html4/boxplots_original-1.png" width="672" /></p>
<pre class="r"><code>ggplot(nema_long,
       aes(sample = exp(Log_pop) - 1)) +
  stat_qq() +
  facet_wrap(~ Variety,
             ncol = 2) +
  theme_minimal()</code></pre>
<p><img src="Fitting_Nematode_Models_files/figure-html4/qq_original-1.png" width="672" /></p>
<p>The boxplots show that there is a wide range of values with the 25 ˚C
temperature populations close to zero with others having quite large ranges,
this could indicate heteroscedasticity.</p>
<p>Also, looking at the qq-plots it is apparent that the original data do not meet
the assumptions of normally distributed errors for a linear model. See the
<a href="#further-reading">Further Reading</a> section for suggested reading on interpreting qq-plots.</p>
<pre class="r"><code>ggplot(nema_long,
       aes(x = Temperature, 
           y = Log_pop,
           group = Temperature,
           colour = Temperature)) +
  geom_boxplot(colour = &quot;grey&quot;,
               outlier.color = NA) +
  geom_jitter(width = 0.1,
              alpha = 0.6) +
  ylab(expression(paste(&quot;exp(ln(&quot;,
                        italic(&quot;P. thornei&quot;),
                        &quot;/kg soil) + 1)&quot;),
                  sep = &quot;&quot;)) +
  facet_wrap( ~ Variety,
              ncol = 2) +
  scale_colour_viridis(&quot;Temperature&quot;) +
  ggtitle(&quot;Log Transformed Data&quot;) +
  theme_minimal()</code></pre>
<p><img src="Fitting_Nematode_Models_files/figure-html4/boxplots_ln-1.png" width="672" /></p>
<pre class="r"><code>ggplot(nema_long,
       aes(sample = Log_pop)) +
  stat_qq() +
  facet_wrap(~ Variety,
             ncol = 2) +
  theme_minimal()</code></pre>
<p><img src="Fitting_Nematode_Models_files/figure-html4/qq_ln-1.png" width="672" /></p>
<p>Here we see that the <code>log()</code> transformed data’s boxplots show fewer outliers and
tighter range of values. The qq-plots also indicate that it is possible to
conduct a linear regression with these data.</p>
</div>
<div id="using-aic-to-compare-model-quality" class="section level2">
<h2>Using AIC to Compare Model Quality</h2>
<p>Even though the original paper used a linear model for the unplanted data, a
polynomial model also fits these data quite well. We can compare the original
linear model from the paper with a polynomial model quite easily in R to see how
the models compare using AIC (Akaike information criterion). AIC is used to
measure the models’ relative quality to each other.</p>
<p>Since the <code>unplanted_model</code> object already exists as a product of the linear
model, we simply need to use the polynomial model with the unplanted data to
create a new object to compare them.</p>
<pre class="r"><code>unplanted_poly_model &lt;- nema_long %&gt;%
  filter(Variety == &quot;Unplanted&quot;) %&gt;% 
  quadratic_model()

par(mfrow = c(2, 2))
plot(unplanted_poly_model)</code></pre>
<p><img src="Fitting_Nematode_Models_files/figure-html4/unplanted_poly-1.png" width="672" /></p>
<pre class="r"><code>summary(unplanted_poly_model)</code></pre>
<pre><code>## 
## Call:
## lm(formula = Log_pop ~ Degree_days + I(Degree_days^2), data = df)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.48697 -0.23865 -0.08038  0.19211  0.97466 
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       5.062e+00  4.031e-01  12.556 3.14e-11 ***
## Degree_days       2.125e-03  8.511e-04   2.497   0.0209 *  
## I(Degree_days^2) -4.010e-07  4.016e-07  -0.999   0.3293    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3848 on 21 degrees of freedom
## Multiple R-squared:  0.7101, Adjusted R-squared:  0.6825 
## F-statistic: 25.72 on 2 and 21 DF,  p-value: 2.255e-06</code></pre>
<p>By this information, the <span class="math inline">\(R^2\)</span> value is a bit better from the
<code>unplanted_poly_model</code>, 0.7101253, than
the original <code>unplanted_model</code>’s, 0.6963592.
Using the same code from above it is easy to visualise the new model’s fit using
<strong><code>ggplot2</code></strong>.</p>
<pre class="r"><code>nema_long %&gt;%
  group_by(Variety) %&gt;%
  filter(Variety == &quot;Unplanted&quot;) %&gt;%
  ggplot(aes(
    x = Degree_days,
    y = Log_pop,
    colour = Temperature,
  )) +
  geom_point() +
  geom_smooth(method = &quot;lm&quot;,
              formula = y ~ x + I(x^2),
              size = 1,
              se = FALSE,
              colour = &quot;grey&quot;,
              alpha = 0.5) +
  ylab(expression(paste(&quot;ln(&quot;,
                        italic(&quot;P. thornei&quot;),
                        &quot;/kg soil) + 1&quot;),
                  sep = &quot;&quot;)) +
  xlab(&quot;Thermal Time (˚C Days Above 10˚C)&quot;) +
  theme_minimal() +
  scale_colour_viridis(&quot;Temperature&quot;) +
  ggtitle(&quot;Unplanted Quadratic Model&quot;)</code></pre>
<p><img src="Fitting_Nematode_Models_files/figure-html4/visualise_unplanted_poly_model-1.png" width="672" /></p>
<p>Checking the model fit visually, we can see that it fits the data nicely. To get
a better feel for how these models compare, AIC can be used to determine the
relative quality of a model for a <em>given set of data</em>. That is, you cannot
compare models for other data using AIC.</p>
<p>Checking the AIC is quite simple in R, just <code>AIC()</code>. Here we check the AIC of
the original linear <code>unplanted_model</code> and the new <code>unplanted_poly_model</code>.</p>
<pre class="r"><code>AIC(unplanted_model)</code></pre>
<pre><code>## [1] 26.17149</code></pre>
<pre class="r"><code>AIC(unplanted_poly_model)</code></pre>
<pre><code>## [1] 27.05797</code></pre>
<p>Ideally when fitting models, you look for the least complex model that provides
the best explanation of the variation in the data. In this case the original
linear model has a lower AIC, 26.1714857, than that of the
polynomial model, 27.0579669, but they are extremely close
and the <span class="math inline">\(R^2\)</span> value of the polynomial model,
0.7101253, is a bit better than the linear
model’s <span class="math inline">\(R^2\)</span>, 0.6963592, as well.
Therefore, without more data to distinguish the models it appears that either
model suffices for the data provided.</p>
</div>
</div>
<div id="further-reading" class="section level1">
<h1>Further Reading</h1>
<div id="tidy-data" class="section level2">
<h2>Tidy Data</h2>
<p>Wickham <span class="citation">(2014)</span> introduced the idea of tidy data for analysis. As you
work with raw data from many sources, it is useful to understand what this means
and why it is useful. In this example, <strong><code>tidyr</code></strong> was used to convert the data
from wide to long format. For a more in-depth look at using <strong><code>tidyr</code></strong> see:</p>
<ul>
<li><p><a href="https://blog.rstudio.com/2014/07/22/introducing-tidyr/">Introducing tidyr</a></p></li>
<li><p><a href="http://tidyr.tidyverse.org/reference/gather.html">Gather columns into key-value pairs</a>.</p></li>
</ul>
</div>
<div id="interpreting-linear-models-in-r" class="section level2">
<h2>Interpreting Linear Models in R</h2>
<p>The University of Georgia has a nice, easy to understand set of materials that
demonstrate how to interpret diagnostic plot outputs from <code>plot(lm.object)</code>,
<a href="http://strata.uga.edu/8370/rtips/regressionPlots.html">Regression diagnostic plots</a>
on their Data Analysis in the Geosciences page. For even more, this
Cross Validated question has an excellent discussion on
<a href="https://stats.stackexchange.com/questions/58141/interpreting-plot-lm">Interpreting plot.lm()</a>.</p>
<p>The University of Montana provides an on-line text, “<em>Statistics With R</em>”, that
includes a section on <a href="https://arc.lib.montana.edu/book/statistics-with-r-textbook/item/57">ANOVA model diagnostics including QQ-plots</a>.
Since ANOVA uses <code>lm()</code> in R, the tools and descriptions here are applicable to
the qq-plots we have generated here in this illustration.</p>
<p>For a detailed look at how to interpret the output from <code>summary()</code> for linear
models, see The YHAT Blog post,
<a href="http://blog.yhat.com/posts/r-lm-summary.html">Fitting &amp; Interpreting Linear Models in R</a>.</p>
<p>Faraway <span class="citation">(2002)</span>,
“<a href="https://cran.r-project.org/doc/contrib/Faraway-PRA.pdf"><em>Practical Regression and Anova using R</em></a>”
is an excellent free resource that goes into detail about fitting linear models
using R and how to interpret the diagnostics. Prof. Faraway has more recent
books on the subject as well that you might wish to borrow from your library or
purchase, see
<a href="http://www.maths.bath.ac.uk/~jjf23/LMR/" class="uri">http://www.maths.bath.ac.uk/~jjf23/LMR/</a>
for more details.</p>
</div>
<div id="selecting-the-right-colour-scheme" class="section level2">
<h2>Selecting the Right Colour Scheme</h2>
<p>Selecting good colour schemes is essential for communicating your message.
The <strong><code>viridis</code></strong> package makes this much easier to do. Bob Rudis has a nice
blog post when the package was first introduced that demonstrates why it is
useful to use a package like this for your colour palettes,
<a href="https://rud.is/b/2015/07/20/using-the-new-viridis-colormap-in-r-thanks-to-simon-garnier/">Using the new ‘viridis’ colormap in R (thanks to Simon Garnier)</a>. Other colour palettes for R exist as well. Notably the
<strong><code>RColorBrewer</code></strong> package provides an easy-to-use interface for the fantastic
Colour Brewer palettes <a href="http://colorbrewer2.org/" class="uri">http://colorbrewer2.org/</a>
commonly used for cartography but also useful for graphs.</p>
</div>
</div>
<div id="reproducibility" class="section level1">
<h1>Reproducibility</h1>
<pre><code>## Session info -------------------------------------------------------------</code></pre>
<pre><code>##  setting  value                       
##  version  R version 3.4.3 (2017-11-30)
##  system   x86_64, darwin16.7.0        
##  ui       unknown                     
##  language (EN)                        
##  collate  en_AU.UTF-8                 
##  tz       Australia/Brisbane          
##  date     2018-02-13</code></pre>
<pre><code>## Packages -----------------------------------------------------------------</code></pre>
<pre><code>##  package     * version    date       source                          
##  assertthat    0.2.0      2017-04-11 CRAN (R 3.4.3)                  
##  backports     1.1.2      2017-12-13 CRAN (R 3.4.3)                  
##  base        * 3.4.3      2018-01-15 local                           
##  bindr         0.1        2016-11-13 CRAN (R 3.4.3)                  
##  bindrcpp    * 0.2        2017-06-17 CRAN (R 3.4.3)                  
##  blogdown      0.5        2018-01-24 cran (@0.5)                     
##  bookdown      0.6        2018-01-25 cran (@0.6)                     
##  broom         0.4.3      2017-11-20 CRAN (R 3.4.3)                  
##  cellranger    1.1.0      2016-07-27 CRAN (R 3.4.3)                  
##  cli           1.0.0      2017-11-05 CRAN (R 3.4.3)                  
##  colorspace    1.3-2      2016-12-14 CRAN (R 3.4.3)                  
##  compiler      3.4.3      2018-01-15 local                           
##  crayon        1.3.4      2017-09-16 CRAN (R 3.4.3)                  
##  datasets    * 3.4.3      2018-01-15 local                           
##  devtools      1.13.4     2017-11-09 CRAN (R 3.4.3)                  
##  digest        0.6.15     2018-01-28 cran (@0.6.15)                  
##  dplyr       * 0.7.4      2017-09-28 CRAN (R 3.4.3)                  
##  evaluate      0.10.1     2017-06-24 CRAN (R 3.4.3)                  
##  forcats     * 0.2.0      2017-01-23 CRAN (R 3.4.3)                  
##  foreign       0.8-69     2017-06-22 CRAN (R 3.4.3)                  
##  ggplot2     * 2.2.1.9000 2018-02-12 Github (hadley/ggplot2@39e4a3b) 
##  glue          1.2.0      2017-10-29 CRAN (R 3.4.3)                  
##  graphics    * 3.4.3      2018-01-15 local                           
##  grDevices   * 3.4.3      2018-01-15 local                           
##  grid          3.4.3      2018-01-15 local                           
##  gridExtra     2.3        2017-09-09 CRAN (R 3.4.3)                  
##  gtable        0.2.0      2016-02-26 CRAN (R 3.4.3)                  
##  haven         1.1.1      2018-01-18 cran (@1.1.1)                   
##  hms           0.4.1      2018-01-24 cran (@0.4.1)                   
##  htmltools     0.3.6      2017-04-28 CRAN (R 3.4.3)                  
##  httr          1.3.1      2017-08-20 CRAN (R 3.4.3)                  
##  jsonlite      1.5        2017-06-01 CRAN (R 3.4.3)                  
##  kableExtra  * 0.7.0      2018-01-15 CRAN (R 3.4.3)                  
##  knitr         1.19       2018-01-29 cran (@1.19)                    
##  labeling      0.3        2014-08-23 CRAN (R 3.4.3)                  
##  lattice       0.20-35    2017-03-25 CRAN (R 3.4.3)                  
##  lazyeval      0.2.1      2017-10-29 CRAN (R 3.4.3)                  
##  lubridate     1.7.2      2018-02-06 cran (@1.7.2)                   
##  magrittr      1.5        2014-11-22 CRAN (R 3.4.3)                  
##  memoise       1.1.0      2017-04-21 CRAN (R 3.4.3)                  
##  methods     * 3.4.3      2018-01-15 local                           
##  mnormt        1.5-5      2016-10-15 CRAN (R 3.4.3)                  
##  modelr        0.1.1      2017-07-24 CRAN (R 3.4.3)                  
##  munsell       0.4.3      2016-02-13 CRAN (R 3.4.3)                  
##  nlme          3.1-131    2017-02-06 CRAN (R 3.4.3)                  
##  parallel      3.4.3      2018-01-15 local                           
##  pillar        1.1.0      2018-01-14 CRAN (R 3.4.3)                  
##  pkgconfig     2.0.1      2017-03-21 CRAN (R 3.4.3)                  
##  plyr          1.8.4      2016-06-08 CRAN (R 3.4.3)                  
##  psych         1.7.8      2017-09-09 CRAN (R 3.4.3)                  
##  purrr       * 0.2.4      2017-10-18 CRAN (R 3.4.3)                  
##  R6            2.2.2      2017-06-17 CRAN (R 3.4.3)                  
##  Rcpp          0.12.15    2018-01-20 cran (@0.12.15)                 
##  readr       * 1.1.1      2017-05-16 CRAN (R 3.4.3)                  
##  readxl        1.0.0      2017-04-18 CRAN (R 3.4.3)                  
##  reshape2      1.4.3      2017-12-11 CRAN (R 3.4.3)                  
##  rlang         0.1.6.9003 2018-02-12 Github (tidyverse/rlang@616fd4d)
##  rmarkdown     1.8        2017-11-17 CRAN (R 3.4.3)                  
##  rprojroot     1.3-2      2018-01-03 CRAN (R 3.4.3)                  
##  rstudioapi    0.7        2017-09-07 CRAN (R 3.4.3)                  
##  rvest         0.3.2      2016-06-17 CRAN (R 3.4.1)                  
##  scales        0.5.0.9000 2018-01-16 Github (hadley/scales@d767915)  
##  stats       * 3.4.3      2018-01-15 local                           
##  stringi       1.1.6      2017-11-17 CRAN (R 3.4.3)                  
##  stringr     * 1.2.0      2017-02-18 CRAN (R 3.4.3)                  
##  tibble      * 1.4.2      2018-01-22 cran (@1.4.2)                   
##  tidyr       * 0.8.0      2018-01-29 cran (@0.8.0)                   
##  tidyselect    0.2.3      2017-11-06 CRAN (R 3.4.3)                  
##  tidyverse   * 1.2.1      2017-11-14 cran (@1.2.1)                   
##  tools         3.4.3      2018-01-15 local                           
##  utils       * 3.4.3      2018-01-15 local                           
##  viridis     * 0.5.0      2018-02-02 cran (@0.5.0)                   
##  viridisLite * 0.3.0      2018-02-01 cran (@0.3.0)                   
##  withr         2.1.1.9000 2018-01-16 Github (jimhester/withr@df18523)
##  xfun          0.1        2018-01-22 cran (@0.1)                     
##  xml2          1.2.0      2018-01-24 cran (@1.2.0)                   
##  yaml          2.1.16     2017-12-12 CRAN (R 3.4.3)</code></pre>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references">
<div id="ref-FARAWAY2002">
<p>Faraway, J. J. 2002. <em>Practical Regression and Anova using R</em>. [University of Bath]. Available at: <a href="https://cran.r-project.org/doc/contrib/Faraway-PRA.pdf" class="uri">https://cran.r-project.org/doc/contrib/Faraway-PRA.pdf</a>.</p>
</div>
<div id="ref-VIRIDIS2018">
<p>Garnier, S. 2018. <em>Viridis: Default color maps from ’matplotlib’</em>. Available at: <a href="https://CRAN.R-project.org/package=viridis" class="uri">https://CRAN.R-project.org/package=viridis</a>.</p>
</div>
<div id="ref-R2017">
<p>R Core Team. 2017. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. Available at: <a href="https://www.R-project.org/" class="uri">https://www.R-project.org/</a>.</p>
</div>
<div id="ref-THOMPSON2015">
<p>Thompson, J. 2015. Modelling population densities of root-lesion nematode (<em>Pratylenchus thornei</em>) from soil profile temperatures to choose an optimum sowing date for wheat in a subtropical region. Field Crops Research. 183:50–55 Available at: <a href="http://www.sciencedirect.com/science/article/pii/S0378429015300083" class="uri">http://www.sciencedirect.com/science/article/pii/S0378429015300083</a>.</p>
</div>
<div id="ref-GGPLOT22009">
<p>Wickham, H. 2016. <em>ggplot2: Elegant Graphics for Data Analysis</em>. Springer-Verlag New York. Available at: <a href="http://ggplot2.org" class="uri">http://ggplot2.org</a>.</p>
</div>
<div id="ref-TIDY-DATA2014">
<p>Wickham, H. 2014. Tidy data. The Journal of Statistical Software. 59 Available at: <a href="http://www.jstatsoft.org/v59/i10/" class="uri">http://www.jstatsoft.org/v59/i10/</a>.</p>
</div>
<div id="ref-TIDYVERSE2017">
<p>Wickham, H. 2017. <em>tidyverse: Easily Install and Load the ’Tidyverse’</em>. Available at: <a href="https://CRAN.R-project.org/package=tidyverse" class="uri">https://CRAN.R-project.org/package=tidyverse</a>.</p>
</div>
<div id="ref-TIDYR2018">
<p>Wickham, H., and Henry, L. 2018. <em>tidyr: Easily Tidy Data with ’spread()’ and ’gather()’ Functions</em>. Available at: <a href="https://CRAN.R-project.org/package=tidyr" class="uri">https://CRAN.R-project.org/package=tidyr</a>.</p>
</div>
<div id="ref-DPLYR2017">
<p>Wickham, H., Francois, R., Henry, L., and Müller, K. 2017. <em>dplyr: A Grammar of Data Manipulation</em>. Available at: <a href="https://CRAN.R-project.org/package=dplyr" class="uri">https://CRAN.R-project.org/package=dplyr</a>.</p>
</div>
<div id="ref-READR2017">
<p>Wickham, H., Hester, J., and Francois, R. 2017. <em>readr: Read Rectangular Text Data</em>. Available at: <a href="https://CRAN.R-project.org/package=readr" class="uri">https://CRAN.R-project.org/package=readr</a>.</p>
</div>
</div>
</div>

