<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
      margin-bottom: 0em;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
  <title>Using Reproducible Research to Revisit Published Results</title>

  <meta property="description" itemprop="description" content="In which the author revisits a previously published analysis and finds ways to improve it while using reproducible research to illustrate refitting a GAM using random effects to better fit the model to the data."/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2024-04-27"/>
  <meta property="article:created" itemprop="dateCreated" content="2024-04-27"/>
  <meta name="article:author" content="Adam H. Sparks"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Using Reproducible Research to Revisit Published Results"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="In which the author revisits a previously published analysis and finds ways to improve it while using reproducible research to illustrate refitting a GAM using random effects to better fit the model to the data."/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Using Reproducible Research to Revisit Published Results"/>
  <meta property="twitter:description" content="In which the author revisits a previously published analysis and finds ways to improve it while using reproducible research to illustrate refitting a GAM using random effects to better fit the model to the data."/>

  <!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Aerial spread of smut spores during peanut harvest;citation_publisher=Springer Science; Business Media LLC;citation_doi=10.1007/s40858-024-00645-5;citation_issn=1983-2052;citation_author=Juan A. Paredes;citation_author=Adam H. Sparks;citation_author=Joaquín H. Monguillot;citation_author=Alejandro M. Rago;citation_author=Juan. P. Edwards Molina"/>
  <meta name="citation_reference" content="citation_title=Research compendium: Aerial dispersion of smut spores during peanut harvest;citation_publisher=Open Science Framework;citation_doi=10.17605/OSF.IO/TK978;citation_author=Juan Edwards Molina;citation_author=Adam Sparks;citation_author=Juan Paredes"/>
  <meta name="citation_reference" content="citation_title=Climate change may have limited effect on global risk of potato late blight;citation_publisher=Wiley;citation_volume=20;citation_doi=10.1111/gcb.12587;citation_issn=1365-2486;citation_author=Adam H. Sparks;citation_author=Gregory A. Forbes;citation_author=Robert J. Hijmans;citation_author=Karen A. Garrett"/>
  <meta name="citation_reference" content="citation_title=Adamhsparks/global-late-blight-MetaModelling: v1.2.0;citation_publisher=Zenodo;citation_doi=10.5281/ZENODO.10701588;citation_author=Adam H. Sparks"/>
  <meta name="citation_reference" content="citation_title=The role of conidia in the dispersal of &lt;i&gt;ascochyta rabiei&lt;/i&gt;;citation_publisher=Springer Science; Business Media LLC;citation_volume=158;citation_doi=10.1007/s10658-020-02126-2;citation_issn=1573-8469;citation_author=Ihsanul Khaliq;citation_author=Joshua Fanning;citation_author=Paul Melloy;citation_author=Jean Galloway;citation_author=Kevin Moore;citation_author=Daniel Burrell;citation_author=Adam H. Sparks"/>
  <meta name="citation_reference" content="citation_title=Raw data for &quot;The role of conidia in the dispersal of &lt;i&gt;Ascochyta rabiei&lt;/i&gt;&quot;;citation_publisher=Zenodo;citation_doi=10.5281/ZENODO.3842293;citation_author=Ihsanul Khaliq;citation_author=Joshua Fanning;citation_author=Paul Melloy;citation_author=Jean Galloway;citation_author=Kevin Moore;citation_author=Daniel Burrell;citation_author=Adam H. Sparks"/>
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","output","bibliography","categories"]}},"value":[{"type":"character","attributes":{},"value":["Using Reproducible Research to Revisit Published Results"]},{"type":"character","attributes":{},"value":["In which the author revisits a previously published analysis and finds ways to improve it while using reproducible research to illustrate refitting a GAM using random effects to better fit the model to the data.\n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Adam H. Sparks"]},{"type":"character","attributes":{},"value":["https://rstats.me/@adamhsparks"]}]}]},{"type":"character","attributes":{},"value":["2024-04-27"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[false]}]}]},{"type":"character","attributes":{},"value":["bibliography.bib"]},{"type":"character","attributes":{},"value":["R4PlantPath","Reproducible Research"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["bibliography.bib","using-reproducible-research-to-revisit-published-results_files/anchor-4.2.2/anchor.min.js","using-reproducible-research-to-revisit-published-results_files/bowser-1.9.3/bowser.min.js","using-reproducible-research-to-revisit-published-results_files/distill-2.2.21/template.v2.js","using-reproducible-research-to-revisit-published-results_files/figure-html5/gam-check-new-1.png","using-reproducible-research-to-revisit-published-results_files/figure-html5/gam-check-org-1.png","using-reproducible-research-to-revisit-published-results_files/header-attrs-2.26/header-attrs.js","using-reproducible-research-to-revisit-published-results_files/jquery-3.6.0/jquery-3.6.0.js","using-reproducible-research-to-revisit-published-results_files/jquery-3.6.0/jquery-3.6.0.min.js","using-reproducible-research-to-revisit-published-results_files/jquery-3.6.0/jquery-3.6.0.min.map","using-reproducible-research-to-revisit-published-results_files/popper-2.6.0/popper.min.js","using-reproducible-research-to-revisit-published-results_files/tippy-6.2.7/tippy-bundle.umd.min.js","using-reproducible-research-to-revisit-published-results_files/tippy-6.2.7/tippy-light-border.css","using-reproducible-research-to-revisit-published-results_files/tippy-6.2.7/tippy.css","using-reproducible-research-to-revisit-published-results_files/tippy-6.2.7/tippy.umd.min.js","using-reproducible-research-to-revisit-published-results_files/webcomponents-2.0.0/webcomponents.js"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
    font-size: 100%;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  hr.section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    margin: 0px;
  }


  d-byline {
    border-top: none;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
    border-top: none;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  /* tweak for Pandoc numbered line within distill */
  d-article pre.numberSource code > span {
      left: -2em;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // separator
    var separator = '<hr class="section-separator" style="clear: both"/>';
    // prepend separator above appendix
    $('.d-byline').before(separator);
    $('.d-article').before(separator);

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme, except when numbering line
    // in code chunk
    $('pre:not(.numberLines) code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        var author_name = front_matter.authors[i].author
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        const citeChild = $(this).children()[0]
        // Do not process if @xyz has been used without escaping and without bibliography activated
        // https://github.com/rstudio/distill/issues/466
        if (citeChild === undefined) return true

        if (citeChild.nodeName == "D-FOOTNOTE") {
          var fn = citeChild
          $(this).html(fn.shadowRoot.querySelector("sup"))
          $(this).id = fn.id
          fn.remove()
        }
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          // Could use CSS.escape too here, we insure backward compatibility in navigator
          return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // fix footnotes in tables (#411)
      // replacing broken distill.pub feature
      $('table d-footnote').each(function() {
        // we replace internal showAtNode methode which is triggered when hovering a footnote
        this.hoverBox.showAtNode = function(node) {
          // ported from https://github.com/distillpub/template/pull/105/files
          calcOffset = function(elem) {
              let x = elem.offsetLeft;
              let y = elem.offsetTop;
              // Traverse upwards until an `absolute` element is found or `elem`
              // becomes null.
              while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                  x += elem.offsetLeft;
                  y += elem.offsetTop;
              }

              return { left: x, top: y };
          }
          // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
          const bbox = node.getBoundingClientRect();
          const offset = calcOffset(node);
          this.show([offset.left + bbox.width, offset.top + bbox.height]);
        }
      })

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      // ignore leaflet img layers (#106)
      figures = figures.filter(':not(img[class*="leaflet"])')
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="using-reproducible-research-to-revisit-published-results_files/header-attrs-2.26/header-attrs.js"></script>
  <script src="using-reproducible-research-to-revisit-published-results_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="using-reproducible-research-to-revisit-published-results_files/popper-2.6.0/popper.min.js"></script>
  <link href="using-reproducible-research-to-revisit-published-results_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="using-reproducible-research-to-revisit-published-results_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="using-reproducible-research-to-revisit-published-results_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="using-reproducible-research-to-revisit-published-results_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="using-reproducible-research-to-revisit-published-results_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="using-reproducible-research-to-revisit-published-results_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="using-reproducible-research-to-revisit-published-results_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Using Reproducible Research to Revisit Published Results","description":"In which the author revisits a previously published analysis and finds ways to improve it while using reproducible research to illustrate refitting a GAM using random effects to better fit the model to the data.","authors":[{"author":"Adam H. Sparks","authorURL":"https://rstats.me/@adamhsparks","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2024-04-27T00:00:00.000+08:00","citationText":"Sparks, 2024"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Using Reproducible Research to Revisit Published Results</h1>

<!--radix_placeholder_categories-->
<div class="dt-tags">
<div class="dt-tag">R4PlantPath</div>
<div class="dt-tag">Reproducible Research</div>
</div>
<!--/radix_placeholder_categories-->
<p><p>In which the author revisits a previously published analysis and finds ways to improve it while using reproducible research to illustrate refitting a GAM using random effects to better fit the model to the data.</p></p>
</div>

<div class="d-byline">
  Adam H. Sparks <a href="https://rstats.me/@adamhsparks" class="uri">https://rstats.me/@adamhsparks</a> 
  
<br/>2024-04-27
</div>

<div class="d-article">
<h2 id="note-on-further-refinement">Note on Further Refinement</h2>
<p>I realised I neglected to explore including the pots at each station and the plants in each pot for the random effects.
The <code>mod_new</code> now includes these and the model fit is further improved with their inclusion.
-ahs 2024-04-28</p>
<h2 id="introduction">Introduction</h2>
<p>I’ve recently just wrapped up an analysis with co-authors looking at the aerial dispersal of peanut smut spores from infested fields in Argentina <span class="citation" data-cites="Paredes2024 EdwardsMolina2022">(<a href="#ref-Paredes2024" role="doc-biblioref">Paredes et al. 2024</a>; <a href="#ref-EdwardsMolina2022" role="doc-biblioref">Edwards Molina, Sparks, and Paredes 2022</a>)</span>.
In this paper, we used a Generalised Additive Model (GAM) to <a href="https://epifito.github.io/peanut_smut_aerial/gam_model.html">describe how far the spores spread and what was linked with this</a> in the R programming environment.
This model was particularly difficult for me to fit initially due to spatial autocorrelation effects due to the spore trap locations and time-slices that were used to collect the spore counts.
It also had six different fields where data were collected.
So there were lots of things going on here, six fields, traps on transects in four directions from the centroid with traps located four distances on the transect and the time in which spores were collected overlapped from 0-90, 0-180 and 0-270 minutes.</p>
<p>To deal with all of this I spent lots of time <a href="https://fromthebottomoftheheap.net/2021/02/02/random-effects-in-gams/">reading up on fitting GAMs</a>, but this time, I was reading about using random effects in the GAM, which is something I’d not done in the past.
I used GAMs in the past for work in my <a href="https://codeberg.org/adamhsparks/Global_Potato_LB_Metamodelling">PhD dissertation</a> <span class="citation" data-cites="Sparks2014 Sparks2024">(<a href="#ref-Sparks2014" role="doc-biblioref">Sparks et al. 2014</a>; <a href="#ref-Sparks2024" role="doc-biblioref">Sparks 2024</a>)</span> and in “The role of conidia in the dispersal of <em>Ascochyta rabiei</em>” <span class="citation" data-cites="Khaliq2020 Khaliq2020a">(<a href="#ref-Khaliq2020" role="doc-biblioref">Khaliq et al. 2020b</a>, <a href="#ref-Khaliq2020a" role="doc-biblioref">2020a</a>)</span>, which brings me to today’s post.</p>
<p>To handle all of the issues with multiple field sites and the spatio-temporal autocorrelation, I used random effects in my GAM for <span class="citation" data-cites="Paredes2024">Paredes et al. (<a href="#ref-Paredes2024" role="doc-biblioref">2024</a>)</span>.
However, I realised I’d not used random effects for <a href="https://adamhsparks.github.io/ChickpeaAscoDispersal/articles/a05_GAM.html/">this work</a> <span class="citation" data-cites="Khaliq2020 Khaliq2020a">(<a href="#ref-Khaliq2020" role="doc-biblioref">Khaliq et al. 2020b</a>, <a href="#ref-Khaliq2020a" role="doc-biblioref">2020a</a>)</span>.
So, to rectify this, I thought I’d go back to the published work and see if I could improve my model’s fit to the data using random effects.</p>
<p>As we set up the research compendium as an R package, it’s easy enough to install it and get started working with the data and reproduce the work published in <span class="citation" data-cites="Khaliq2020">Khaliq et al. (<a href="#ref-Khaliq2020" role="doc-biblioref">2020b</a>)</span>.
We assume that you have the R package <a href="https://devtools.r-lib.org/">{devtools}</a> installed, if not, use <code>install.packages("devtools")</code>.</p>
<h2 id="getting-started">Getting Started</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://devtools.r-lib.org/'>"devtools"</a></span><span class='op'>)</span></span>
<span><span class='fu'>install_github</span><span class='op'>(</span><span class='st'>"https://github.com/adamhsparks/ChickpeaAscoDispersal"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Now we can load the data, <code>lesion_counts</code> and <code>summary_weather</code>, from {ChickpeaAscoDispersal} and create the <code>dat</code> object used to fit the GAM in the original paper.</p>
<p>We will use <code>set.seed()</code> here to ensure that the same results are obtained when checking the model fits.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://tidyverse.tidyverse.org'>"tidyverse"</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://github.com/adamhsparks/ChickpeaAscoDispersal'>"ChickpeaAscoDispersal"</a></span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>27</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>dat</span> <span class='op'>&lt;-</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>lesion_counts</span>, <span class='va'>summary_weather</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"site"</span>, <span class='st'>"rep"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>             SpEv                   site     rep        distance    
 Curyo Rain 1  :56   Curyo            : 56   1:168   Min.   : 0.00  
 Horsham Irrg 1:56   Horsham dryland  :112   2:112   1st Qu.:10.00  
 Horsham Irrg 2:56   Horsham irrigated:168   3: 56   Median :25.00  
 Horsham Mixd 1:56                                   Mean   :32.68  
 Horsham Rain 1:56                                   3rd Qu.:50.00  
 Horsham Rain 2:56                                   Max.   :75.00  
                                                                    
    station          transect       plant_no         pot_no     
 Min.   : 1.000   Min.   : 1.0   Min.   :3.000   Min.   : 1.00  
 1st Qu.: 2.000   1st Qu.: 3.0   1st Qu.:3.000   1st Qu.:14.75  
 Median : 4.000   Median : 5.5   Median :5.000   Median :28.50  
 Mean   : 4.643   Mean   : 5.5   Mean   :4.286   Mean   :28.50  
 3rd Qu.: 7.000   3rd Qu.: 8.0   3rd Qu.:5.000   3rd Qu.:42.25  
 Max.   :10.000   Max.   :10.0   Max.   :5.000   Max.   :56.00  
                                                                
   counts_p1        counts_p2       counts_p3        counts_p4     
 Min.   : 0.000   Min.   :0.000   Min.   : 0.000   Min.   : 0.000  
 1st Qu.: 0.000   1st Qu.:0.000   1st Qu.: 0.000   1st Qu.: 0.000  
 Median : 1.000   Median :0.000   Median : 0.000   Median : 1.000  
 Mean   : 1.243   Mean   :1.021   Mean   : 1.096   Mean   : 1.406  
 3rd Qu.: 2.000   3rd Qu.:2.000   3rd Qu.: 2.000   3rd Qu.: 2.000  
 Max.   :12.000   Max.   :8.000   Max.   :11.000   Max.   :11.000  
 NA&#39;s   :2        NA&#39;s   :2       NA&#39;s   :2        NA&#39;s   :124     
   counts_p5         degrees         ptype             m_lesions     
 Min.   : 0.000   Min.   : 10.0   Length:336         Min.   :0.0000  
 1st Qu.: 0.000   1st Qu.: 65.0   Class :character   1st Qu.:0.3333  
 Median : 1.000   Median : 95.0   Mode  :character   Median :0.6667  
 Mean   : 1.333   Mean   :118.0                      Mean   :1.0802  
 3rd Qu.: 2.000   3rd Qu.:127.5                      3rd Qu.:1.4000  
 Max.   :14.000   Max.   :360.0                      Max.   :8.4000  
 NA&#39;s   :132                                         NA&#39;s   :2       
      mws            ws_sd            mwd           sum_rain   
 Min.   :1.903   Min.   :0.905   Min.   :234.7   Min.   : 0.8  
 1st Qu.:2.233   1st Qu.:1.290   1st Qu.:272.7   1st Qu.: 4.6  
 Median :3.331   Median :2.031   Median :321.7   Median :11.0  
 Mean   :3.554   Mean   :1.867   Mean   :306.3   Mean   : 9.6  
 3rd Qu.:3.996   3rd Qu.:2.230   3rd Qu.:333.7   3rd Qu.:11.6  
 Max.   :6.532   Max.   :2.713   Max.   :353.5   Max.   :18.6  
                                                               </code></pre>
</div>
<h2 id="fitting-the-gams">Fitting the GAMs</h2>
<p>With the data now loaded in our R session, we can fit the original GAM as published for us to compare against and see if we can’t improve it.</p>
<h3 id="original-gam">Original GAM</h3>
<p>First, fit the original model as published.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'>"mgcv"</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>mod_org</span> <span class='op'>&lt;-</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/mgcv/man/gam.html'>gam</a></span><span class='op'>(</span></span>
<span>    <span class='va'>m_lesions</span> <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/pkg/mgcv/man/s.html'>s</a></span><span class='op'>(</span><span class='va'>distance</span>, k <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>      <span class='fu'><a href='https://rdrr.io/pkg/mgcv/man/s.html'>s</a></span><span class='op'>(</span><span class='va'>mws</span>, k <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>      <span class='fu'><a href='https://rdrr.io/pkg/mgcv/man/s.html'>s</a></span><span class='op'>(</span><span class='va'>sum_rain</span>, k <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span>,</span>
<span>    data <span class='op'>=</span> <span class='va'>dat</span>,</span>
<span>    family <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/mgcv/man/Tweedie.html'>tw</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>mod_org</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>
Family: Tweedie(p=1.044) 
Link function: log 

Formula:
m_lesions ~ s(distance, k = 5) + s(mws, k = 5) + s(sum_rain, 
    k = 5)

Parametric coefficients:
            Estimate Std. Error t value     Pr(&gt;|t|)    
(Intercept) -0.22823    0.04098  -5.569 0.0000000539 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Approximate significance of smooth terms:
              edf Ref.df       F              p-value    
s(distance) 3.496  3.855 123.776 &lt; 0.0000000000000002 ***
s(mws)      1.992  2.092   0.824              0.45080    
s(sum_rain) 2.812  2.879   5.493              0.00168 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

R-sq.(adj) =  0.674   Deviance explained = 61.2%
-REML = 309.96  Scale est. = 0.36397   n = 334</code></pre>
</div>
<h3 id="new-gam-with-random-effects">New GAM With Random Effects</h3>
<p>Now fit a model with random effects for the site (Curyo or Horsham), rep (3) and station (10 per each of 10 transects), pot number and plant number to see if it improves the model fit to the data.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>mod_new</span> <span class='op'>&lt;-</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/mgcv/man/gam.html'>gam</a></span><span class='op'>(</span></span>
<span>    <span class='va'>m_lesions</span> <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/pkg/mgcv/man/s.html'>s</a></span><span class='op'>(</span><span class='va'>distance</span>, k <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>      <span class='fu'><a href='https://rdrr.io/pkg/mgcv/man/s.html'>s</a></span><span class='op'>(</span><span class='va'>mws</span>, k <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>      <span class='fu'><a href='https://rdrr.io/pkg/mgcv/man/s.html'>s</a></span><span class='op'>(</span><span class='va'>sum_rain</span>, k <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>      <span class='fu'><a href='https://rdrr.io/pkg/mgcv/man/s.html'>s</a></span><span class='op'>(</span><span class='va'>site</span>, <span class='va'>rep</span>, <span class='va'>station</span>, <span class='va'>pot_no</span>, <span class='va'>plant_no</span>, bs <span class='op'>=</span> <span class='st'>"re"</span><span class='op'>)</span>,</span>
<span>    data <span class='op'>=</span> <span class='va'>dat</span>,</span>
<span>    family <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/mgcv/man/Tweedie.html'>tw</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>mod_new</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>
Family: Tweedie(p=1.043) 
Link function: log 

Formula:
m_lesions ~ s(distance, k = 5) + s(mws, k = 5) + s(sum_rain, 
    k = 5) + s(site, rep, station, pot_no, plant_no, bs = &quot;re&quot;)

Parametric coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -0.08424    0.06155  -1.369    0.172

Approximate significance of smooth terms:
                                      edf Ref.df      F
s(distance)                         3.650  3.924 65.908
s(mws)                              1.919  2.049  1.997
s(sum_rain)                         2.797  2.878  5.440
s(site,rep,station,pot_no,plant_no) 4.924  6.000  4.058
                                                 p-value    
s(distance)                         &lt; 0.0000000000000002 ***
s(mws)                                           0.29429    
s(sum_rain)                                      0.00125 ** 
s(site,rep,station,pot_no,plant_no)            0.0000601 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

R-sq.(adj) =   0.71   Deviance explained = 64.5%
-REML = 301.99  Scale est. = 0.36131   n = 334</code></pre>
</div>
<p>Here we’ve added a new line, <code>s(site, rep, station, pot_no, plant_no, bs = "re")</code> for the random effects.
This indicates that we now have a smoothed term for ‘site’, ‘rep’ (replicate), and ‘station’ with <code>bs = "re"</code>, where the basis (<code>bs</code>) for the smooth is a random effect (<code>re</code>).</p>
<p>We can see that the <span class="math inline">\(R^2\)</span> value has increased, 0.7099145 vs 0.6737655 and that the deviance explained has also increased, 64.5% vs 61.2%.</p>
<p>In the original paper, we used AIC to compare models to ensure we didn’t over fit and used the most parsimonious model possible.
As we’ve added new terms it’s best to check to ensure that we’ve not added unnecessary complexity to the model.</p>
<h3 id="compare-aic-values">Compare AIC Values</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://broom.tidymodels.org/'>"broom"</a></span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>models</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>mod_org <span class='op'>=</span> <span class='va'>mod_org</span>,</span>
<span>               mod_new <span class='op'>=</span> <span class='va'>mod_new</span></span>
<span>               <span class='op'>)</span></span>
<span></span>
<span><span class='va'>mod_aic</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map_dfr.html'>map_df</a></span><span class='op'>(</span><span class='va'>models</span>, <span class='va'>glance</span>,</span>
<span>                  .id <span class='op'>=</span> <span class='st'>"model"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>   <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>AIC</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>mod_aic</span></span></code></pre>
</div>
<pre><code># A tibble: 2 × 8
  model      df logLik   AIC   BIC deviance df.residual  nobs
  &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt; &lt;int&gt;
1 mod_new 14.3   -271.  578.  645.     129.        320.   334
2 mod_org  9.30  -288.  599.  644.     141.        325.   334</code></pre>
</div>
<p>The AIC does improve with the new model, 578 to the original’s, 599, enough to likely warrant the added complexity to the model I’d say.
It is of note that the BIC is larger for the new model, 645, to the original’s, 644, so further diagnostics should be used as we did in the paper.</p>
<h3 id="check-using-model-fit-with-descriptive-statistics-and-figures">Check Using Model Fit With Descriptive Statistics and Figures</h3>
<p>Lastly, we can use <code>gam.check()</code> as in the paper to evaluate the models fitness.</p>
<h4 id="original-khaliq-et-al.-model">Original Khaliq <em>et al.</em> Model</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/mgcv/man/gam.check.html'>gam.check</a></span><span class='op'>(</span><span class='va'>mod_org</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="using-reproducible-research-to-revisit-published-results_files/figure-html5/gam-check-org-1.png" width="624" /></p>
<pre><code>
Method: REML   Optimizer: outer newton
full convergence after 8 iterations.
Gradient range [-0.0000004288943,0.0000002610557]
(score 309.9554 &amp; scale 0.3639671).
Hessian positive definite, eigenvalue range [0.3685077,2978.832].
Model rank =  13 / 13 

Basis dimension (k) checking results. Low p-value (k-index&lt;1) may
indicate that k is too low, especially if edf is close to k&#39;.

              k&#39;  edf k-index p-value  
s(distance) 4.00 3.50    0.87   0.025 *
s(mws)      4.00 1.99    0.98   0.535  
s(sum_rain) 4.00 2.81    1.00   0.625  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<h4 id="updated-model-with-random-effects">Updated Model With Random Effects</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/mgcv/man/gam.check.html'>gam.check</a></span><span class='op'>(</span><span class='va'>mod_new</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="using-reproducible-research-to-revisit-published-results_files/figure-html5/gam-check-new-1.png" width="624" /></p>
<pre><code>
Method: REML   Optimizer: outer newton
full convergence after 10 iterations.
Gradient range [-0.00007401781,0.00003895846]
(score 301.9894 &amp; scale 0.3613127).
Hessian positive definite, eigenvalue range [0.3078677,2958.934].
Model rank =  22 / 22 

Basis dimension (k) checking results. Low p-value (k-index&lt;1) may
indicate that k is too low, especially if edf is close to k&#39;.

                                      k&#39;  edf k-index p-value
s(distance)                         4.00 3.65    0.91    0.13
s(mws)                              4.00 1.92    1.04    0.88
s(sum_rain)                         4.00 2.80    1.05    0.91
s(site,rep,station,pot_no,plant_no) 9.00 4.92      NA      NA</code></pre>
</div>
<p>The original model’s “distance” term <span class="math inline">\(k-index\)</span> was a bit iffy as it was indicated to be significant, but otherwise acceptable for what we wanted as we weren’t forward predicting, just explaining what happened at our trial sites.
It indicated that the <span class="math inline">\(k\)</span> value was too low, which is fair, we only had <span class="math inline">\(k = 5\)</span> due to a lack of degrees of freedom.
Adding the random effects increased the estimated degrees of freedom available and resulted in a better fitting model in the new model’s form with random effects included.</p>
<p>The qq-plot and other diagnostics for the new model also show a slight visual improvement over the original model.
Especially the response vs. predicted variables showing much less of a pattern.</p>
<h2 id="conclusion">Conclusion</h2>
<p>In conclusion, this was a fun little exercise that allowed me to explore some new things I’ve learned along the way and apply them to some older work very easily.
This isn’t worth going back to the original paper and making any changes as it doesn’t change the story one bit.
However, it is nice to see that I was able to take the original work and so easily reproduce it and then upgrade it and confirm what I thought and will be useful information for future work.</p>
<h2 id="further-resources">Further Resources</h2>
<p>Here’s a few more resources that are useful for GAMs.</p>
<ul>
<li><a href="https://noamross.github.io/gams-in-r-course/">A Free, Interactive Course using mgcv</a> from Noam Ross, highly recommended, great exercises and examples.</li>
<li><a href="https://ecogambler.netlify.app/blog/">GAMbler</a> from Nicholas Clark, ecology focus but has great support for GAMs.</li>
<li><a href="https://fromthebottomoftheheap.net/blog/">From the bottom of the heap</a> from Gavin Simpson, I already mentioned this blog at the beginning of the post, but it’s worth mentioning again for the great materials that Ben has put together and shared.</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-EdwardsMolina2022" class="csl-entry" role="listitem">
Edwards Molina, Juan, Adam Sparks, and Juan Paredes. 2022. <span>“Research Compendium: Aerial Dispersion of Smut Spores During Peanut Harvest.”</span> <a href="https://doi.org/10.17605/OSF.IO/TK978">https://doi.org/10.17605/OSF.IO/TK978</a>.
</div>
<div id="ref-Khaliq2020a" class="csl-entry" role="listitem">
Khaliq, Ihsanul, Joshua Fanning, Paul Melloy, Jean Galloway, Kevin Moore, Daniel Burrell, and Adam H. Sparks. 2020a. <span>“Raw Data for "<span class="nocase">The role of conidia in the dispersal of <em>Ascochyta rabiei</em></span>".”</span> Zenodo. <a href="https://doi.org/10.5281/ZENODO.3842293">https://doi.org/10.5281/ZENODO.3842293</a>.
</div>
<div id="ref-Khaliq2020" class="csl-entry" role="listitem">
———. 2020b. <span>“The Role of Conidia in the Dispersal of <em>Ascochyta Rabiei</em>.”</span> <em>European Journal of Plant Pathology</em> 158 (4): 911–24. <a href="https://doi.org/10.1007/s10658-020-02126-2">https://doi.org/10.1007/s10658-020-02126-2</a>.
</div>
<div id="ref-Paredes2024" class="csl-entry" role="listitem">
Paredes, Juan A., Adam H. Sparks, Joaquín H. Monguillot, Alejandro M. Rago, and Juan. P. Edwards Molina. 2024. <span>“Aerial Spread of Smut Spores During Peanut Harvest.”</span> <em>Tropical Plant Pathology</em>, March. <a href="https://doi.org/10.1007/s40858-024-00645-5">https://doi.org/10.1007/s40858-024-00645-5</a>.
</div>
<div id="ref-Sparks2024" class="csl-entry" role="listitem">
Sparks, Adam H. 2024. <span>“Adamhsparks/Global-Late-Blight-MetaModelling: V1.2.0.”</span> Zenodo. <a href="https://doi.org/10.5281/ZENODO.10701588">https://doi.org/10.5281/ZENODO.10701588</a>.
</div>
<div id="ref-Sparks2014" class="csl-entry" role="listitem">
Sparks, Adam H., Gregory A. Forbes, Robert J. Hijmans, and Karen A. Garrett. 2014. <span>“Climate Change May Have Limited Effect on Global Risk of Potato Late Blight.”</span> <em>Global Change Biology</em> 20 (12): 3621–31. <a href="https://doi.org/10.1111/gcb.12587">https://doi.org/10.1111/gcb.12587</a>.
</div>
</div>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr />
<ol>
<li id="fn1"><p>I also learned something new by writing this blog post.
When I started I didn’t realise that <code>gam.check()</code> used random draws to check the fit.
In the case of these models, it can make a difference in the significance of the “distance” term.
In most cases it’s not significant when checking the fit of the new model, but in some cases it remains significant as with the original model.
The seed chosen (at random) does make it insignificant.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="references">References</h3>
<div id="references-listing"></div>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
